const e="https://669a78899ba098ed61ffc5a3.mockapi.io/accounts",t=async t=>{try{let a=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!a.ok)throw Error("Network response was not ok");return await a.json()}catch(e){throw Error(`Registration failed: ${e.message}`)}},a=async()=>{try{let t=await fetch(e);if(!t.ok)throw Error("Network response was not ok");return await t.json()}catch(e){throw Error(`Failed to fetch profiles: ${e.message}`)}};document.addEventListener("DOMContentLoaded",()=>{let e=document.querySelector(".profile__circle"),i=document.querySelector(".regButton"),s=document.querySelector(".logButton"),r=document.querySelector("#logout-button"),n=document.querySelector(".register__form"),o=document.querySelector(".login__form"),l=o?o.querySelector(".error-message"):null,c=n?n.querySelector(".error-message"):null,d=document.querySelector(".register__modal"),u=document.querySelector(".login__modal"),g=document.querySelector(".tryButton"),v=()=>{let t=localStorage.getItem("userProfile");if(e){if(t){e.classList.remove("change__invisible"),r&&r.classList.remove("change__invisible"),i&&i.classList.add("change__invisible"),s&&s.classList.add("change__invisible");let a=JSON.parse(t);e.textContent=a.name[0].toUpperCase()}else e.classList.add("change__invisible"),r&&r.classList.add("change__invisible"),i&&i.classList.remove("change__invisible"),s&&s.classList.remove("change__invisible")}};v(),n&&n.addEventListener("submit",async e=>{e.preventDefault(),c&&(c.textContent="");let a=e.target.elements.profilename.value,i=e.target.elements.profilesurname.value,s=e.target.elements.profilelogin.value,r=e.target.elements.profilepassword.value;if(!a||!i||!s||!r){c&&(c.textContent="Please fill in all fields");return}let n={name:a,surname:i,login:s,password:r};try{console.log("Registering profile:",n),await t(n),localStorage.setItem("userProfile",JSON.stringify(n)),v(),d&&d.classList.add("change__invisible")}catch(e){c&&(c.textContent="Registration failed. Please try again."),console.error("Registration failed:",e)}}),o&&o.addEventListener("submit",async e=>{e.preventDefault(),l&&(l.textContent="");let t=e.target.elements.profilelogin.value,i=e.target.elements.profilepassword.value;if(!t||!i){l&&(l.textContent="Please fill in all fields");return}try{console.log("Logging in with:",t);let e=(await a()).find(e=>e.login===t&&e.password===i);e?(localStorage.setItem("userProfile",JSON.stringify(e)),v(),u&&u.classList.add("change__invisible")):l&&(l.textContent="Invalid login or password. Please try again.")}catch(e){l&&(l.textContent="Login failed. Please try again."),console.error("Login failed:",e)}}),r&&r.addEventListener("click",()=>{localStorage.removeItem("userProfile"),v()}),i&&i.addEventListener("click",()=>{d&&d.classList.remove("change__invisible")}),s&&s.addEventListener("click",()=>{u&&u.classList.remove("change__invisible")}),g&&g.addEventListener("click",()=>{d&&d.classList.remove("change__invisible")})});const i=document.querySelector(".regButton"),s=document.querySelector(".register__modal"),r=document.querySelector(".logButton"),n=document.querySelector(".login__modal"),o=document.querySelectorAll(".cross__svg");i.addEventListener("click",e=>{s.classList.remove("change__invisible"),n.classList.add("change__invisible")}),r.addEventListener("click",e=>{n.classList.remove("change__invisible"),s.classList.add("change__invisible")}),o[0].addEventListener("click",()=>{n.classList.add("change__invisible"),s.classList.add("change__invisible"),console.log(123)}),o[1].addEventListener("click",()=>{n.classList.add("change__invisible"),s.classList.add("change__invisible"),console.log(123)}),document.addEventListener("DOMContentLoaded",()=>{let e=document.getElementById("reviews-container"),t=document.getElementById("review-form"),a=document.getElementById("review-name"),i=document.getElementById("review-text"),s=document.getElementById("review-rating"),r=document.getElementById("submit-button"),n=JSON.parse(localStorage.getItem("userProfile"))||{},o=0,l=async()=>{try{let t=await fetch("https://669b6b40276e45187d3569df.mockapi.io/reviews");if(!t.ok)throw Error("Network response was not ok");let a=await t.json();e.innerHTML=a.map(e=>`
                <div class="review">
                    <div class="review__avatar">${e.name[0].toUpperCase()}</div>
                    <div class="review__content">
                        <p class="review__name">${e.name}</p>
                        <p class="review__text">${e.text}</p>
                        <p class="review__rating">\u{420}\u{435}\u{439}\u{442}\u{438}\u{43D}\u{433}: ${"★".repeat(e.rating)}</p>
                    </div>
                </div>
            `).join("")}catch(e){console.error("Failed to fetch reviews:",e)}},c=async(e,t,a)=>{try{if(!(await fetch("https://669b6b40276e45187d3569df.mockapi.io/reviews",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,text:t,rating:a})})).ok)throw Error("Network response was not ok");l()}catch(e){console.error("Failed to add review:",e)}},d=async e=>{try{let t=await fetch("https://669b6b40276e45187d3569df.mockapi.io/reviews");if(!t.ok)throw Error("Network response was not ok");return(await t.json()).some(t=>t.name===e)}catch(e){return console.error("Failed to check user reviews:",e),!1}},u=e=>{document.querySelectorAll(".star").forEach(t=>{t.classList.toggle("selected",t.dataset.value<=e)})};s.addEventListener("click",e=>{e.target.classList.contains("star")&&u(o=parseInt(e.target.dataset.value,10))}),t.addEventListener("submit",async e=>{e.preventDefault();let t=a.value,s=i.value;t&&s&&o>0&&(await d(t)?alert("Ви вже залишали відгук."):(c(t,s,o),i.value="",u(o=0)))}),l(),n.name?(a.value=n.name,a.readOnly=!0,i.disabled=!1,r.disabled=!1):(a.value="",a.readOnly=!0,i.disabled=!0,r.disabled=!0)});
//# sourceMappingURL=index.fc443671.js.map
