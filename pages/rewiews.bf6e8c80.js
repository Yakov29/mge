document.addEventListener("DOMContentLoaded",()=>{let e=document.getElementById("reviews-container"),t=document.getElementById("review-form"),a=document.getElementById("review-name"),r=document.getElementById("review-text"),o=document.getElementById("review-rating"),i=document.querySelector("button[type='submit']"),n=JSON.parse(localStorage.getItem("userProfile"))||{},s=0,d=async()=>{try{let t=await fetch("https://669b6b40276e45187d3569df.mockapi.io/reviews");if(!t.ok)throw Error("Network response was not ok");let a=await t.json();e.innerHTML=a.map(e=>`
                <div class="review">
                    <div class="review__content">
                        <p class="review__name">${e.name}</p>
                        <p class="review__text">${e.text}</p>
                        <p class="review__rating">\u{420}\u{435}\u{439}\u{442}\u{438}\u{43D}\u{433}: ${"★".repeat(e.rating)}</p>
                        ${n.admin?`<button class="delete-review" data-id="${e.id}"></button>`:""}
                    </div>
                </div>
            `).join(""),n.admin&&u()}catch(e){console.error("Failed to fetch reviews:",e)}},c=async(e,t,a)=>{try{if(!(await fetch("https://669b6b40276e45187d3569df.mockapi.io/reviews",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,text:t,rating:a})})).ok)throw Error("Network response was not ok");d()}catch(e){console.error("Failed to add review:",e)}},l=async e=>{try{let t=await fetch("https://669b6b40276e45187d3569df.mockapi.io/reviews");if(!t.ok)throw Error("Network response was not ok");return(await t.json()).some(t=>t.name===e)}catch(e){return console.error("Failed to check user reviews:",e),!1}},w=e=>{document.querySelectorAll(".star").forEach(t=>{t.classList.toggle("selected",t.dataset.value<=e)})},u=()=>{document.querySelectorAll(".delete-review").forEach(e=>{e.addEventListener("click",async()=>{let t=e.dataset.id;try{if(!(await fetch(`https://669b6b40276e45187d3569df.mockapi.io/reviews/${t}`,{method:"DELETE"})).ok)throw Error("Network response was not ok");d()}catch(e){console.error("Failed to delete review:",e)}})})};o.addEventListener("click",e=>{e.target.classList.contains("star")&&w(s=parseInt(e.target.dataset.value,10))}),t.addEventListener("submit",async e=>{e.preventDefault();let t=a.value,o=r.value;t&&o&&s>0&&(await l(t)?alert("Ви вже залишали відгук."):(c(t,o,s),r.value="",w(s=0)))}),d(),n.name?(a.value=n.name,a.readOnly=!0,r.disabled=!1,i.disabled=!1):(a.value="",a.readOnly=!0,r.disabled=!0,i.disabled=!0)});
//# sourceMappingURL=rewiews.bf6e8c80.js.map
