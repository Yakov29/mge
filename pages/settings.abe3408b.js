var e=globalThis,t={},o={},n=e.parcelRequirecf3a;null==n&&((n=function(e){if(e in t)return t[e].exports;if(e in o){var n=o[e];delete o[e];var i={id:e,exports:{}};return t[e]=i,n.call(i.exports,i,i.exports),i.exports}var a=Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(e,t){o[e]=t},e.parcelRequirecf3a=n),(0,n.register)("6byIg",function(e,t){document.addEventListener("DOMContentLoaded",()=>{let e=document.querySelector("#profileCircle"),t=document.querySelector("#profileModal"),o=document.querySelector("#notificationsModal"),n=document.querySelector("#closeProfileModal"),i=document.querySelector("#closeNotificationsModal"),a=document.querySelector("#notificationsButton"),r=document.querySelector("#settingsForm"),s=document.querySelector("#profileName"),l=document.querySelector("#notificationForm"),c=document.querySelector("#notificationsList"),f=async e=>{e.preventDefault();let t=document.querySelector("#notificationMessage").value,o=JSON.parse(localStorage.getItem("userProfile")),n=o?o.login:null;if(!n){console.error("User login is not available.");return}try{let e=await fetch(`https://669a78899ba098ed61ffc5a3.mockapi.io/accounts?login=${n}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Network response was not ok");let o=(await e.json())[0],i=[...o.notifications,t];if(!(await fetch(`https://669a78899ba098ed61ffc5a3.mockapi.io/accounts/${o.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...o,notifications:i})})).ok)throw Error("Network response was not ok");await d(),l&&l.reset()}catch(e){console.error("Sending notification failed:",e)}},d=async()=>{let e=JSON.parse(localStorage.getItem("userProfile")),t=e?e.login:null;if(!t){console.error("User login is not available.");return}try{let e=await fetch(`https://669a78899ba098ed61ffc5a3.mockapi.io/accounts?login=${t}`);if(!e.ok)throw Error("Network response was not ok");let o=await e.json(),n=o[0]?.notifications||[];c&&(c.innerHTML=n.map((e,t)=>`<div class="notification-item">
                        <p>${e}</p>
                        <button data-index="${t}" class="delete-notification">&times;</button>
                    </div>`).join("")),p()}catch(e){console.error("Fetching notifications failed:",e)}},p=()=>{document.querySelectorAll(".delete-notification").forEach(e=>{e.addEventListener("click",async()=>{let t=e.dataset.index,o=JSON.parse(localStorage.getItem("userProfile")),n=o?o.login:null;if(!n){console.error("User login is not available.");return}try{let e=await fetch(`https://669a78899ba098ed61ffc5a3.mockapi.io/accounts?login=${n}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Network response was not ok");let o=(await e.json())[0],i=o.notifications.filter((e,o)=>o!==parseInt(t,10));if(!(await fetch(`https://669a78899ba098ed61ffc5a3.mockapi.io/accounts/${o.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...o,notifications:i})})).ok)throw Error("Network response was not ok");await d()}catch(e){console.error("Deleting notification failed:",e)}})})},u=()=>{t&&(t.style.display="none")},y=async()=>{let t=JSON.parse(localStorage.getItem("userProfile")),o=t?t.login:null;if(o)try{let t=await fetch(`https://669a78899ba098ed61ffc5a3.mockapi.io/accounts?login=${o}`);if(!t.ok)throw Error("Network response was not ok");let n=(await t.json())[0];e&&(e.textContent=n.name[0].toUpperCase(),e.style.display="flex"),s&&(s.textContent=`${n.name} ${n.surname}`)}catch(e){console.error("Fetching user profile failed:",e)}else e&&(e.style.display="none"),s&&(s.textContent="Ім'я користувача")};e&&e.addEventListener("click",()=>{t&&(t.style.display="flex")}),n&&n.addEventListener("click",u),a&&a.addEventListener("click",()=>{o&&(o.style.display="flex",d())}),i&&i.addEventListener("click",()=>{o&&(o.style.display="none")}),r&&r.addEventListener("submit",async e=>{e.preventDefault();let t=Object.fromEntries(new FormData(r).entries()),o=JSON.parse(localStorage.getItem("userProfile")),n=o?o.login:null;if(!n){console.error("User login is not available.");return}try{let e=await fetch(`https://669a78899ba098ed61ffc5a3.mockapi.io/accounts?login=${n}`);if(!e.ok)throw Error("Network response was not ok");let o=(await e.json())[0];if(!(await fetch(`https://669a78899ba098ed61ffc5a3.mockapi.io/accounts/${o.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...o,...t})})).ok)throw Error("Network response was not ok");alert("Налаштування збережено"),u()}catch(e){console.error("Updating profile failed:",e)}}),l&&l.addEventListener("submit",f),y()})}),n("6byIg");
//# sourceMappingURL=settings.abe3408b.js.map
