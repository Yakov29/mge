var e=globalThis,t={},r={},a=e.parcelRequirecf3a;null==a&&((a=function(e){if(e in t)return t[e].exports;if(e in r){var a=r[e];delete r[e];var i={id:e,exports:{}};return t[e]=i,a.call(i.exports,i,i.exports),i.exports}var n=Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}).register=function(e,t){r[e]=t},e.parcelRequirecf3a=a),a.register;const i="https://669a78899ba098ed61ffc5a3.mockapi.io/accounts",n=async e=>{try{let t=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error("Network response was not ok");return await t.json()}catch(e){throw Error(`Registration failed: ${e.message}`)}},o=async()=>{try{let e=await fetch(i);if(!e.ok)throw Error("Network response was not ok");return await e.json()}catch(e){throw Error(`Failed to fetch profiles: ${e.message}`)}};document.addEventListener("DOMContentLoaded",()=>{let e=document.querySelector(".profile__circle"),t=document.querySelector(".regButton"),r=document.querySelector(".logButton"),a=document.querySelector("#logout-button"),i=document.querySelector("#board-link"),l=document.querySelector(".register__form"),s=document.querySelector(".login__form"),c=s?s.querySelector(".error-message"):null,d=l?l.querySelector(".error-message"):null,u=document.querySelector(".register__modal"),g=document.querySelector(".login__modal"),m=document.querySelector(".tryButton"),f=()=>{let n=localStorage.getItem("userProfile");if(e){if(n){e.classList.remove("change__invisible"),a&&a.classList.remove("change__invisible"),i&&i.classList.remove("change__invisible"),t&&t.classList.add("change__invisible"),r&&r.classList.add("change__invisible");let o=JSON.parse(n);e.textContent=o.name[0].toUpperCase()}else e.classList.add("change__invisible"),a&&a.classList.add("change__invisible"),i&&i.classList.add("change__invisible"),t&&t.classList.remove("change__invisible"),r&&r.classList.remove("change__invisible")}},v=async e=>{try{return(await o()).some(t=>t.login===e)}catch(e){return console.error("Failed to check login availability:",e),!1}};f(),l&&l.addEventListener("submit",async e=>{e.preventDefault(),d&&(d.textContent="");let t=e.target.elements.profilename.value,r=e.target.elements.profilesurname.value,a=e.target.elements.profilelogin.value,i=e.target.elements.profilepassword.value;if(!t||!r||!a||!i){d&&(d.textContent="Please fill in all fields");return}if(await v(a)){d&&(d.textContent="Login is already taken. Please choose another one.");return}let o={name:t,surname:r,login:a,password:i};try{await n(o),localStorage.setItem("userProfile",JSON.stringify(o)),f(),u&&u.classList.add("change__invisible")}catch(e){d&&(d.textContent="Registration failed. Please try again."),console.error("Registration failed:",e)}}),s&&s.addEventListener("submit",async e=>{e.preventDefault(),c&&(c.textContent="");let t=e.target.elements.profilelogin.value,r=e.target.elements.profilepassword.value;if(!t||!r){c&&(c.textContent="Please fill in all fields");return}try{let e=(await o()).find(e=>e.login===t&&e.password===r);e?(localStorage.setItem("userProfile",JSON.stringify(e)),f(),g&&g.classList.add("change__invisible")):c&&(c.textContent="Invalid login or password. Please try again.")}catch(e){c&&(c.textContent="Login failed. Please try again."),console.error("Login failed:",e)}}),a&&a.addEventListener("click",()=>{localStorage.removeItem("userProfile"),f()}),t&&t.addEventListener("click",()=>{u&&u.classList.remove("change__invisible")}),r&&r.addEventListener("click",()=>{g&&g.classList.remove("change__invisible")}),m&&m.addEventListener("click",()=>{u&&u.classList.remove("change__invisible")});let _=e=>{e&&e.classList.add("change__invisible")};document.querySelectorAll(".modal__close").forEach(e=>{e.addEventListener("click",()=>{_(e.closest(".modal"))})}),document.querySelectorAll(".modal-background").forEach(e=>{e.addEventListener("click",t=>{if(t.target===e){let e=t.target.closest(".modal");e&&_(e)}})})}),a("79buJ"),a("6byIg"),a("a0pMX");
//# sourceMappingURL=index.f5d34e9a.js.map
