document.addEventListener("DOMContentLoaded",()=>{let e=document.querySelector(".profile__circle"),t=document.querySelector(".regButton"),a=document.querySelector(".logButton"),r=document.querySelector("#logout-button"),i=document.querySelector(".register__form"),n=document.querySelector(".login__form"),s=n?n.querySelector(".error-message"):null,l=i?i.querySelector(".error-message"):null,o=document.querySelector(".register__modal"),c=document.querySelector(".login__modal"),d=document.querySelector(".tryButton"),u=()=>{let i=localStorage.getItem("userProfile");if(e){if(i){e.classList.remove("change__invisible"),r&&r.classList.remove("change__invisible"),t&&t.classList.add("change__invisible"),a&&a.classList.add("change__invisible");let n=JSON.parse(i);e.textContent=n.name[0].toUpperCase()}else e.classList.add("change__invisible"),r&&r.classList.add("change__invisible"),t&&t.classList.remove("change__invisible"),a&&a.classList.remove("change__invisible")}};u(),i&&i.addEventListener("submit",async e=>{e.preventDefault(),l&&(l.textContent="");let t=e.target.elements.profilename.value,a=e.target.elements.profilesurname.value,r=e.target.elements.profilelogin.value,i=e.target.elements.profilepassword.value;if(!t||!a||!r||!i){l&&(l.textContent="Please fill in all fields");return}let n={name:t,surname:a,login:r,password:i};try{await addProfile(n),localStorage.setItem("userProfile",JSON.stringify(n)),u(),o&&o.classList.add("change__invisible")}catch(e){l&&(l.textContent="Registration failed. Please try again."),console.error("Registration failed:",e)}}),n&&n.addEventListener("submit",async e=>{e.preventDefault(),s&&(s.textContent="");let t=e.target.elements.profilelogin.value,a=e.target.elements.profilepassword.value;if(!t||!a){s&&(s.textContent="Please fill in all fields");return}try{let e=(await getProfiles()).find(e=>e.login===t&&e.password===a);e?(localStorage.setItem("userProfile",JSON.stringify(e)),u(),c&&c.classList.add("change__invisible")):s&&(s.textContent="Invalid login or password. Please try again.")}catch(e){s&&(s.textContent="Login failed. Please try again."),console.error("Login failed:",e)}}),r&&r.addEventListener("click",()=>{localStorage.removeItem("userProfile"),u()}),t&&t.addEventListener("click",()=>{o&&o.classList.remove("change__invisible")}),a&&a.addEventListener("click",()=>{c&&c.classList.remove("change__invisible")}),d&&d.addEventListener("click",()=>{o&&o.classList.remove("change__invisible")})}),document.addEventListener("DOMContentLoaded",()=>{let e=document.getElementById("reviews-container"),t=document.getElementById("review-form"),a=document.getElementById("review-name"),r=document.getElementById("review-text"),i=document.getElementById("review-rating"),n=document.getElementById("submit-button"),s=JSON.parse(localStorage.getItem("userProfile"))||{},l=0,o=async()=>{try{let t=await fetch("https://669b6b40276e45187d3569df.mockapi.io/reviews");if(!t.ok)throw Error("Network response was not ok");let a=await t.json();e.innerHTML=a.map(e=>`
                <div class="review">
                    <div class="review__avatar">${e.name[0].toUpperCase()}</div>
                    <div class="review__content">
                        <p class="review__name">${e.name}</p>
                        <p class="review__text">${e.text}</p>
                        <p class="review__rating">\u{420}\u{435}\u{439}\u{442}\u{438}\u{43D}\u{433}: ${"★".repeat(e.rating)}</p>
                    </div>
                </div>
            `).join("")}catch(e){console.error("Failed to fetch reviews:",e)}},c=async(e,t,a)=>{try{if(!(await fetch("https://669b6b40276e45187d3569df.mockapi.io/reviews",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,text:t,rating:a})})).ok)throw Error("Network response was not ok");o()}catch(e){console.error("Failed to add review:",e)}},d=async e=>{try{let t=await fetch("https://669b6b40276e45187d3569df.mockapi.io/reviews");if(!t.ok)throw Error("Network response was not ok");return(await t.json()).some(t=>t.name===e)}catch(e){return console.error("Failed to check user reviews:",e),!1}},u=e=>{document.querySelectorAll(".star").forEach(t=>{t.classList.toggle("selected",t.dataset.value<=e)})};i.addEventListener("click",e=>{e.target.classList.contains("star")&&u(l=parseInt(e.target.dataset.value,10))}),t.addEventListener("submit",async e=>{e.preventDefault();let t=a.value,i=r.value;t&&i&&l>0&&(await d(t)?alert("Ви вже залишали відгук."):(c(t,i,l),r.value="",u(l=0)))}),o(),s.name?(a.value=s.name,a.readOnly=!0,r.disabled=!1,n.disabled=!1):(a.value="",a.readOnly=!0,r.disabled=!0,n.disabled=!0)});
//# sourceMappingURL=index.e370f961.js.map
