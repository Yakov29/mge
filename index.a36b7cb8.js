var e=globalThis,t={},r={},i=e.parcelRequirecf3a;null==i&&((i=function(e){if(e in t)return t[e].exports;if(e in r){var i=r[e];delete r[e];var o={id:e,exports:{}};return t[e]=o,i.call(o.exports,o,o.exports),o.exports}var a=Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(e,t){r[e]=t},e.parcelRequirecf3a=i),i.register,document.addEventListener("DOMContentLoaded",()=>{let e={register:document.querySelector(".register__modal"),login:document.querySelector(".login__modal"),adminRequest:document.querySelector("#adminRequestModal")},t={register:document.querySelector(".regButton"),login:document.querySelector(".logButton"),adminRequest:document.querySelector(".work__send__btn")},r={register:e.register.querySelector(".cross__svg"),login:e.login.querySelector(".cross__svg"),adminRequest:e.adminRequest.querySelector(".cross__svg")},i=e=>{e.classList.remove("change__invisible")},o=e=>{e.classList.add("change__invisible")},a=(e,t,r)=>{t.addEventListener("click",()=>{i(e)}),r.addEventListener("click",()=>{o(e)}),e.addEventListener("click",t=>{t.target===e&&o(e)}),document.addEventListener("keydown",t=>{"Escape"!==t.key||e.classList.contains("change__invisible")||o(e)})};a(e.register,t.register,r.register),a(e.login,t.login,r.login),a(e.adminRequest,t.adminRequest,r.adminRequest);let n=document.querySelector("#submitAdminRequest"),s=document.querySelector("#adminConfirmation");document.querySelector("#userName"),n.addEventListener("click",async()=>{if("так"===s.value.trim().toLowerCase()){let t=JSON.parse(localStorage.getItem("userProfile"));if(t&&t.login)try{let r=await fetch("https://669a78899ba098ed61ffc5a3.mockapi.io/accounts"),i=(await r.json()).find(e=>e.login===t.login);if(i){let t=await fetch(`https://669a78899ba098ed61ffc5a3.mockapi.io/accounts/${i.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...i,admin:!0})});if(t.ok)alert("Ви стали адміністратором!"),o(e.adminRequest);else{let e=await t.json();console.error(`Error ${t.status}: ${e.message}`),alert("Помилка при оновленні. Спробуйте ще раз.")}}else alert("Користувача не знайдено.")}catch(e){console.error("Error:",e),alert("Помилка при оновленні. Спробуйте ще раз.")}else alert("Ви не увійшли в систему.")}else alert("Введіть 'так', щоб підтвердити.")})});const o="https://669a78899ba098ed61ffc5a3.mockapi.io/accounts",a=async e=>{try{let t=await fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error("Network response was not ok");return await t.json()}catch(e){throw Error(`Registration failed: ${e.message}`)}},n=async()=>{try{let e=await fetch(o);if(!e.ok)throw Error("Network response was not ok");return await e.json()}catch(e){throw Error(`Failed to fetch profiles: ${e.message}`)}};document.addEventListener("DOMContentLoaded",()=>{let e=document.querySelector(".profile__circle"),t=document.querySelector(".regButton"),r=document.querySelector(".logButton"),i=document.querySelector("#logout-button"),o=document.querySelector("#board-link"),s=document.querySelector(".register__form"),l=document.querySelector(".login__form"),c=l?l.querySelector(".error-message"):null,d=s?s.querySelector(".error-message"):null,u=document.querySelector(".register__modal"),g=document.querySelector(".login__modal"),m=document.querySelector(".tryButton"),_=()=>{let a=localStorage.getItem("userProfile");if(e){if(a){e.classList.remove("change__invisible"),i&&i.classList.remove("change__invisible"),o&&o.classList.remove("change__invisible"),t&&t.classList.add("change__invisible"),r&&r.classList.add("change__invisible");let n=JSON.parse(a);e.textContent=n.name[0].toUpperCase()}else e.classList.add("change__invisible"),i&&i.classList.add("change__invisible"),o&&o.classList.add("change__invisible"),t&&t.classList.remove("change__invisible"),r&&r.classList.remove("change__invisible")}},f=async e=>{try{return(await n()).some(t=>t.login===e)}catch(e){return console.error("Failed to check login availability:",e),!1}};_(),s&&s.addEventListener("submit",async e=>{e.preventDefault(),d&&(d.textContent="");let t=e.target.elements.profilename.value,r=e.target.elements.profilesurname.value,i=e.target.elements.profilelogin.value,o=e.target.elements.profilepassword.value;if(!t||!r||!i||!o){d&&(d.textContent="Please fill in all fields");return}if(await f(i)){d&&(d.textContent="Login is already taken. Please choose another one.");return}let n={name:t,surname:r,login:i,password:o};try{await a(n),localStorage.setItem("userProfile",JSON.stringify(n)),_(),u&&u.classList.add("change__invisible")}catch(e){d&&(d.textContent="Registration failed. Please try again."),console.error("Registration failed:",e)}}),l&&l.addEventListener("submit",async e=>{e.preventDefault(),c&&(c.textContent="");let t=e.target.elements.profilelogin.value,r=e.target.elements.profilepassword.value;if(!t||!r){c&&(c.textContent="Please fill in all fields");return}try{let e=(await n()).find(e=>e.login===t&&e.password===r);e?(localStorage.setItem("userProfile",JSON.stringify(e)),_(),g&&g.classList.add("change__invisible")):c&&(c.textContent="Invalid login or password. Please try again.")}catch(e){c&&(c.textContent="Login failed. Please try again."),console.error("Login failed:",e)}}),i&&i.addEventListener("click",()=>{localStorage.removeItem("userProfile"),_()}),t&&t.addEventListener("click",()=>{u&&u.classList.remove("change__invisible")}),r&&r.addEventListener("click",()=>{g&&g.classList.remove("change__invisible")}),m&&m.addEventListener("click",()=>{u&&u.classList.remove("change__invisible")});let v=e=>{e&&e.classList.add("change__invisible")};document.querySelectorAll(".modal__close").forEach(e=>{e.addEventListener("click",()=>{v(e.closest(".modal"))})}),document.querySelectorAll(".modal-background").forEach(e=>{e.addEventListener("click",t=>{if(t.target===e){let e=t.target.closest(".modal");e&&v(e)}})})}),i("6byIg");
//# sourceMappingURL=index.a36b7cb8.js.map
