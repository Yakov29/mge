const e="https://669a78899ba098ed61ffc5a3.mockapi.io/accounts",t=async t=>{try{let a=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!a.ok)throw Error("Network response was not ok");return await a.json()}catch(e){throw Error(`Registration failed: ${e.message}`)}},a=async()=>{try{let t=await fetch(e);if(!t.ok)throw Error("Network response was not ok");return await t.json()}catch(e){throw Error(`Failed to fetch profiles: ${e.message}`)}};document.addEventListener("DOMContentLoaded",()=>{let e=document.querySelector(".profile__circle"),r=document.querySelector(".regButton"),i=document.querySelector(".logButton"),n=document.querySelector("#logout-button"),o=document.querySelector(".register__form"),s=document.querySelector(".login__form"),l=s?s.querySelector(".error-message"):null,c=o?o.querySelector(".error-message"):null,d=document.querySelector(".register__modal"),u=document.querySelector(".login__modal"),m=document.querySelector(".tryButton"),g=()=>{let t=localStorage.getItem("userProfile");if(e){if(t){e.classList.remove("change__invisible"),n&&n.classList.remove("change__invisible"),r&&r.classList.add("change__invisible"),i&&i.classList.add("change__invisible");let a=JSON.parse(t);e.textContent=a.name[0].toUpperCase()}else e.classList.add("change__invisible"),n&&n.classList.add("change__invisible"),r&&r.classList.remove("change__invisible"),i&&i.classList.remove("change__invisible")}};g(),o&&o.addEventListener("submit",async e=>{e.preventDefault(),c&&(c.textContent="");let a=e.target.elements.profilename.value,r=e.target.elements.profilesurname.value,i=e.target.elements.profilelogin.value,n=e.target.elements.profilepassword.value;if(!a||!r||!i||!n){c&&(c.textContent="Please fill in all fields");return}let o={name:a,surname:r,login:i,password:n};try{console.log("Registering profile:",o),await t(o),localStorage.setItem("userProfile",JSON.stringify(o)),g(),d&&d.classList.add("change__invisible")}catch(e){c&&(c.textContent="Registration failed. Please try again."),console.error("Registration failed:",e)}}),s&&s.addEventListener("submit",async e=>{e.preventDefault(),l&&(l.textContent="");let t=e.target.elements.profilelogin.value,r=e.target.elements.profilepassword.value;if(!t||!r){l&&(l.textContent="Please fill in all fields");return}try{console.log("Logging in with:",t);let e=(await a()).find(e=>e.login===t&&e.password===r);e?(localStorage.setItem("userProfile",JSON.stringify(e)),g(),u&&u.classList.add("change__invisible")):l&&(l.textContent="Invalid login or password. Please try again.")}catch(e){l&&(l.textContent="Login failed. Please try again."),console.error("Login failed:",e)}}),n&&n.addEventListener("click",()=>{localStorage.removeItem("userProfile"),g()}),r&&r.addEventListener("click",()=>{d&&d.classList.remove("change__invisible")}),i&&i.addEventListener("click",()=>{u&&u.classList.remove("change__invisible")}),m&&m.addEventListener("click",()=>{d&&d.classList.remove("change__invisible")})}),document.addEventListener("DOMContentLoaded",()=>{let e=document.getElementById("reviews-container"),t=document.getElementById("review-form"),a=document.getElementById("review-name"),r=document.getElementById("review-text"),i=document.getElementById("review-rating"),n=document.getElementById("submit-button"),o=JSON.parse(localStorage.getItem("userProfile"))||{},s=0,l=async()=>{try{let t=await fetch("https://669b6b40276e45187d3569df.mockapi.io/reviews");if(!t.ok)throw Error("Network response was not ok");let a=await t.json();e.innerHTML=a.map(e=>`
                <div class="review">
                    <div class="review__avatar">${e.name[0].toUpperCase()}</div>
                    <div class="review__content">
                        <p class="review__name">${e.name}</p>
                        <p class="review__text">${e.text}</p>
                        <p class="review__rating">\u{420}\u{435}\u{439}\u{442}\u{438}\u{43D}\u{433}: ${"★".repeat(e.rating)}</p>
                    </div>
                </div>
            `).join("")}catch(e){console.error("Failed to fetch reviews:",e)}},c=async(e,t,a)=>{try{if(!(await fetch("https://669b6b40276e45187d3569df.mockapi.io/reviews",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,text:t,rating:a})})).ok)throw Error("Network response was not ok");l()}catch(e){console.error("Failed to add review:",e)}},d=async e=>{try{let t=await fetch("https://669b6b40276e45187d3569df.mockapi.io/reviews");if(!t.ok)throw Error("Network response was not ok");return(await t.json()).some(t=>t.name===e)}catch(e){return console.error("Failed to check user reviews:",e),!1}},u=e=>{document.querySelectorAll(".star").forEach(t=>{t.classList.toggle("selected",t.dataset.value<=e)})};i.addEventListener("click",e=>{e.target.classList.contains("star")&&u(s=parseInt(e.target.dataset.value,10))}),t.addEventListener("submit",async e=>{e.preventDefault();let t=a.value,i=r.value;t&&i&&s>0&&(await d(t)?alert("Ви вже залишали відгук."):(c(t,i,s),r.value="",u(s=0)))}),l(),o.name?(a.value=o.name,a.readOnly=!0,r.disabled=!1,n.disabled=!1):(a.value="",a.readOnly=!0,r.disabled=!0,n.disabled=!0)});
//# sourceMappingURL=index.547fd2f2.js.map
